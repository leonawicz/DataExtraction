<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Matthew Leonawicz" />


<title>Shapefiles to Raster Cell Indices</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="libs/bootstrap-2.3.2/css/united.min.css" rel="stylesheet" />
<link href="libs/bootstrap-2.3.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
<script src="libs/bootstrap-2.3.2/js/bootstrap.min.js"></script>
<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}
@media (max-width: 979px) {
  body {
    padding-top: 0;
  }
}

/* offset scroll position for anchor links (for fixed navbar)  */
@media (min-width: 980px) {
  .section h2 {
    padding-top: 52px;
    margin-top: -52px;
  }
  .section h3 {
    padding-top: 52px;
    margin-top: -52px;
  }
}


/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}

</style>

<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>




</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="container-fluid main-container">

<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="brand" href="index.html">Data Extraction</a>
      <div class="nav-collapse collapse">
        <ul class="nav">
          <li class="dropdown">
            <a href="extraction-evaluation" class="dropdown-toggle" data-toggle="dropdown">Extraction evaluation <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="nav-header">Project</li>
              <li><a href="eval_intro.html">Introduction</a></li>
              <li><a href="eval_case.html">Case study: sample mean</a></li>
              <li><a href="eval_res.html">Results</a></li>
              <li><a href="eval_next.html">Next steps</a></li>
              <li class="divider"></li>
              <li class="nav-header">R Code</li>
              <li><a href="extract_eval_code.html">Complete code</a></li>
            </ul>

          <li class="dropdown">
            <a href="density-estimation" class="dropdown-toggle" data-toggle="dropdown">Density estimation <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="nav-header">Project</li>
              <li><a href="dens_intro.html">Introduction</a></li>
              <li><a href="dens_sims.html">Simulations</a></li>
              <li class="divider"></li>
              <li class="nav-header">Use cases</li>
              <li><a href="dens_use1.html">Case 1: Climate</a></li>
              <li><a href="dens_use2.html">Case 2: Vegetation</a></li>
              <li class="divider"></li>
              <li class="nav-header">R code</li>
              <li><a href="dens_sims_code.html">Basic simulation</a></li>
            </ul>

          <li class="dropdown">
            <a href="pre-indexing" class="dropdown-toggle" data-toggle="dropdown">Pre-indexing <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="nav-header">Project</li>
              <li><a href="ind_intro.html">Introduction</a></li>
              <li><a href="ind_related.html">Related items</a></li>
              <li class="divider"></li>
              <li class="nav-header">R Code</li>
              <li><a href="ind_code.html">Complete code</a></li>
            </ul>

          <li class="dropdown">
            <a href="all-projects" class="dropdown-toggle" data-toggle="dropdown">All Projects <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="proj_sankey.html">Projects diagram</a></li>
              <li class="divider"></li>
              <li><a href="proj_intro.html">About</a></li>
              <li><a href="proj_intro.html">Other</a></li>
            </ul>
        </ul>
        <ul class="nav pull-right">
          <a class="btn btn-primary" href="https://github.com/leonawicz/DataExtraction">
            <i class="fa fa-github fa-lg"></i>
            Github
          </a>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div>

<div id="header">
<h1 class="title">Shapefiles to Raster Cell Indices</h1>
<h4 class="author"><em>Matthew Leonawicz</em></h4>
</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><strong>R</strong> code is provided showing how I convert polygon shapefiles to lists of raster cell indices.</p>
<div id="motivation" class="section level3">
<h3>Motivation</h3>
<p>At SNAP I often find myself performing large numbers of data extractions on raster layers by way of shapefiles. This can be time consuming with respect to our high-resolution downscaled geotiffs. Large raster layers in combination with large (or large numbers of) shapefiles can make for the perfect storm of wasteful and painfully slow processing time. In light of the additional fact that such processing is commonplace at SNAP and that almost any data extraction done once is bound to recur at a later date in some overlapping and redundant sense, I have moved toward an a priori establishment of the more preliminary and repetitive aspects of common spatial data extraction tasks at SNAP.</p>
</div>
<div id="details" class="section level3">
<h3>Details</h3>
<p>I compile the following: * Lists of commonly used groups of polygon shapefiles * Key raster/geotiff format data sets from which we commonly extract data * Settings pertaining to the methods and circumstances under which cell indexing can occur in anticipated, subsequent data extraction exercises</p>
<div id="capabilities" class="section level4">
<h4>Capabilities</h4>
<p>The most straightforward purpose here is to obtain a nested list of groups of related geographic regions based on input shapefiles, each such lower list element storing a vector of cell numbers, or indices, pertaining to a given shapefileâ€™s spatial location over a given rasterized data set. The nested list is named. The top level elements are themselves lists, named based on related shapefile groupings. Each of these lists is originally a list of shapefiles but is transformed into a list of vectors of raster layer cell indices.</p>
<p>Sometimes data extraction is performed on SNAP data sets with explicit a priori removal of <code>NA</code> values. Anticipating this context of usage, cell indices corresponding to shapefiles are also obtained with respect to an NA-omitted version of a raster layer.</p>
<p>Additionally, the context of data extraction procedures sometimes includes sampling methods where not all raster cells are used. Sampling may be applied to rasterized objects in <strong>R</strong> prior to doing any other work with them. As with <code>NA</code> removal, this may be done to improve computational efficiencies. Under these circumstances, obtaining cell indices by shapefile in advance would not work. However, the code below also provides an example of one a priori sampling schemes, the five percent random sample. In anticipation of commonly performing such sampling on raster layers, here this is done in advance by obtaining a representative sample for each shapefile region.</p>
</div>
<div id="limitations" class="section level4">
<h4>Limitations</h4>
<p>Obviously, the vector of cell indices for a shapefile differs for different rasterized data sets. At this time, cell index nested lists are produced for two common rasterized data products at SNAP: * Alaska-Canada 2-km downscaled climate data * Alaska-Canada 1-km Alfresco simulation data</p>
<p>Although the extents are identical, resolutions differ, and hence so do cell numbers pertaining to any given polygon shapefile. Furthermore, taking the climate and Alfresco datasets as an example again, even if they were the same resolution, the Alfresco map has spatial regions of <code>NA</code> where data values exist in the climate layers. This would have an independent effect on the NA-omitted versions of the nested lists. It would also affect sampled versions where <code>NA</code> cells are removed.</p>
<p>These are not really limitations, but trivial facts. The thing to remain aware of is simply that any version of these polygon shapefile-specific nested lists of cell numbers are of course indexed with respect to a specific rasterized dataset.</p>
</div>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
